
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comprehensive Offline Incident Response & Mitigation Guide</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
    h1, h2, h3 { color: #2c3e50; }
    h1 { text-align: center; margin-bottom: 20px; }
    pre { background: #f4f4f4; padding: 10px; overflow: auto; }
    code { background: #eef; padding: 2px 4px; border-radius: 4px; }
    ul { margin-left: 20px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  </style>
</head>
<body>
  <h1>Comprehensive Offline Incident Response & Mitigation Guide</h1>
  <p><em>Date Generated: 2025-05-29</em></p>

  <h2>1. Preparation & Trusted Base</h2>
  <ul>
    <li><strong>Isolate devices physically</strong>: unplug network, disable radios (Wi-Fi, Bluetooth).</li>
    <li><strong>Identify or acquire a trusted clean machine</strong> for initial verifications:
      <ul>
        <li>Borrow a known-clean device, or use a public library/college PC.</li>
        <li>Factory-reset a spare laptop's recovery partition.</li>
        <li>Use a rescue CD or DVD you burned and verified pre-infection.</li>
        <li>As last resort, use a smartphone with Termux/iSH for GPG/sha256 verification.</li>
      </ul>
    </li>
    <li><strong>Gather forensics media</strong>:
      <ul>
        <li>Encrypted external HDD/SSD (LUKS, BitLocker, FileVault).</li>
        <li>Write-blocked USB or hardware WORM device for evidence.</li>
      </ul>
    </li>
    <li><strong>Prepare SD cards, CDs, DVDs</strong> for Live OS installation.</li>
  </ul>

  <h2>2. Offline ISO Verification & Media Creation</h2>
  <ol>
    <li><strong>Download ISOs</strong> (macOS, Fedora, Windows) from official sources using a trusted network.</li>
    <li><strong>Import & verify GPG keys</strong> and manually check fingerprints:
<pre>gpg --keyserver hkps://keys.openpgp.org --recv-keys &lt;KEYID&gt;
gpg --verify filename.iso.sig
sha256sum -c filename.iso.sha256</pre>
    </li>
    <li><strong>Burn to read-only media</strong> (CD/DVD) or create a Live USB via <code>dd</code>:
<pre>dd if=filename.iso of=/dev/sdX bs=1M status=progress oflag=sync</pre>
    </li>
    <li><strong>Disable overlayfs or persistence</strong> so each boot is pristine.</li>
  </ol>

  <h2>3. Forensic Collection & Chain-of-Custody</h2>
  <ul>
    <li><strong>Archive artifacts per device</strong> into timestamped tarballs:</li>
<pre>tar czf hostname_forensics_YYYY-MM-DD.tgz /path/to/artifacts
sha256sum hostname_forensics_YYYY-MM-DD.tgz &gt; archive.sha256
gpg --armor --detach-sign archive.sha256</pre>
    <li><strong>Store archives</strong> on encrypted external media.</li>
    <li><strong>Maintain a log</strong> with Date/Time, Device, Archive Name, Checksum, GPG Signer.</li>
  </ul>

  <h2>4. macOS Incident Response</h2>
  <h3>4.1 Integrity Verification</h3>
  <pre>csrutil status
csrutil authenticated-root status
spctl --status
mount | grep -i apfs
diskutil apfs listSnapshots /
tmutil listlocalsnapshots /
bputil -d</pre>
  <ul>
    <li>Ensure SIP, authenticated-root, Secure Boot, kernel trust are enabled.</li>
    <li>Delete unwanted snapshots in Recovery Mode:</li>
    <pre>tmutil deletelocalsnapshots &lt;date&gt;</pre>
  </ul>
  <h3>4.2 Persistence & Malware Hunting</h3>
  <pre>sudo find /Library/WebServer -type f -maxdepth 3
sudo find /private/etc/raccoon -type f
security dump-keychain > keychain_dump.txt
ps aux | grep -i httpd
lsof -iTCP -sTCP:LISTEN -nP</pre>
  <ul>
    <li>Identify spoofed binaries (e.g., scopedbookmarkagent), Apache clones, raccoon configs.</li>
    <li>Remove malicious files in Recovery then re-seal:</li>
    <pre>bless --folder /System/Library/CoreServices --bootefi --create-snapshot</pre>
  </ul>
  <h3>4.3 Full Erase & Reinstall</h3>
  <ol>
    <li>Boot to Recovery (⌘+R) or DFU restore; open Terminal:</li>
    <pre>diskutil eraseDisk APFS "Macintosh HD" /dev/diskXsY</pre>
    <li>Reinstall macOS from verified media.</li>
    <li>Re-enable SIP & authenticated-root:</li>
    <pre>csrutil enable
csrutil authenticated-root enable</pre>
    <li>Avoid cloud syncs until you've hardened the system.</li>
  </ol>

  <h2>5. Fedora (Linux) Response</h2>
  <h3>5.1 Secure Boot & Kernel Audit</h3>
  <pre>mokutil --sb-state
dmesg | grep -i secureboot</pre>
  <h3>5.2 Rootkit & Package Integrity</h3>
  <pre>sudo rkhunter --check --sk
sudo chkrootkit
sudo rpm -Va | grep '^..5'</pre>
  <h3>5.3 Networking & Services Audit</h3>
  <pre>sudo ss -tulpn
sudo journalctl -xb
lsinitrd /boot/initramfs-$(uname -r).img | less</pre>
  <h3>5.4 Full Reinstall</h3>
  <ol>
    <li>Boot from verified USB; use installer to delete all partitions, create LUKS-encrypted LVM.</li>
    <li>Install minimal system, apply <code>dnf update --refresh</code>, disable unused services.</li>
  </ol>

  <h2>6. Windows Incident Response</h2>
  <h3>6.1 Secure Boot & Startup</h3>
  <pre>Confirm-SecureBootUEFI
Get-CimInstance Win32_StartupCommand
schtasks /query /fo LIST /v</pre>
  <h3>6.2 Unsigned Drivers & DLLs</h3>
  <pre>sigcheck -e -u -q C:\Windows\System32</pre>
  <h3>6.3 Full Reinstall</h3>
  <ol>
    <li>Boot from Windows USB; delete all partitions; install fresh.</li>
    <li>Enable Secure Boot, BitLocker, disable Legacy Boot.</li>
  </ol>

  <h2>7. Network Segmentation & Router Build</h2>
  <h3>7.1 Interim VLANs on Existing Router</h3>
  <ul>
    <li>Create VLANs: CleanNet, IoTNet, Quarantine.</li>
    <li>Apply firewall rules: deny inter-VLAN, whitelist egress.</li>
    <li>Use Pi-hole or DNS sinkhole for logging.</li>
  </ul>
  <h3>7.2 Custom Firewall Appliance</h3>
  <pre># Flash OpenWRT x86-64
pv openwrt-x86-64-generic-squashfs-combined.img > /dev/sdX
</pre>
  <ul>
    <li>Configure VLANs, DHCP, DNS, firewall.</li>
    <li>Install Suricata/pfBlockerNG for IDS/IPS.</li>
  </ul>

  <h2>8. Raspberry Pi as Clean Hub</h2>
  <ul>
    <li>Flash verified Raspberry Pi OS or OpenWRT.</li>
    <li>Install: GPG, sha256sum, clamav, tcpdump, nmap, Pi-hole.</li>
    <li>Use for file verification, DNS filtering, temporary NAT.</li>
  </ul>

  <h2>9. iOS & Mobile Forensics</h2>
  <ul>
    <li>Profiles & Certificates: remove unknown in Settings → General → VPN & Device Management.</li>
    <li>App Audit: delete suspicious apps; disable background refresh & location.</li>
    <li>Network Tests: <code>curl -I https://apple.com</code>, check TLS with <code>openssl s_client -connect apple.com:443</code>.</li>
    <li>Factory Reset if unauthorized apps or profiles found; set up as new.</li>
  </ul>

  <h2>10. Cloud & IoT Hygiene</h2>
  <ul>
    <li>Rotate all passwords and OAuth/App tokens; enable MFA.</li>
    <li>Factory reset IoT devices; reflash firmware; whitelist domains only.</li>
    <li>Quarantine IoT VLAN with minimal egress.</li>
  </ul>

  <h2>11. Troubleshooting & Advanced Scenarios</h2>
  <ul>
    <li><strong>No clean host?</strong> Use Termux/iSH, rescue CD, or OEM recovery partitions.</li>
    <li><strong>BIOS compromised?</strong> Reflash with coreboot or switch to new hardware.</li>
    <li>Monitor for DNS or HTTP callbacks monthly; schedule audits.</li>
  </ul>

  <h2>12. Imaginative Incident Cases</h2>
  <ul>
    <li>**LLM-based malware**: detect Gradio instances, sandbox in Docker, re-prompt in isolation.</li>
    <li>**Cross-platform webserver implants**: Apache clones for Linux & macOS, remove and re-seal.</li>
    <li>**Credential harvesters**: sniff webcache2, keychain dumps, block via DNS firewall.</li>
    <li>**Firmware attacks**: active vs passive FPGA/SoC rootkits, use hardware analyzers if needed.</li>
  </ul>

  <h2>Appendix & References</h2>
  <ul>
    <li>Fedora Docs: https://docs.fedoraproject.org/</li>
    <li>Apple Security Guide: https://support.apple.com/guide/security/welcome/web</li>
    <li>Microsoft Security Docs: https://docs.microsoft.com/windows/security/</li>
    <li>OpenWRT Docs: https://openwrt.org/docs/start</li>
    <li>Coreboot: https://www.coreboot.org/</li>
  </ul>

</body>
</html>
